<!-- Generated by SpecStory -->

<!-- cursor Session 2aa1aa10-3fb9-45c1-82a5-6ab904fca26c (2025-10-31 01:22Z) -->

# Delete mock bookings request (2025-10-31 01:22Z)

_**User (2025-10-31 01:44Z)**_

can you delete mock bookings?

---

_**Assistant (default)**_



---


Searching for mock booking definitions and references.


---

Tool use: **read_file**

Read file: assets/js/components/calendarModal.js

---

Tool use: **grep**

<details>
<summary>Grep for "mock.*booking|mockBooking|mock.*book" • 132 matches</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `.\assets\js\components\bookingModal.js` | `// Mock booking database for availability checking` | L71 |
| `.\assets\js\components\bookingModal.js` | `const mockBookings = \{` | L72 |
| `.\server\server.js` | `mockClient.seed('bookings', [` | L225 |
| `.\server\server.js` | `mockClient.seed('booking_items', [` | L258 |
| `.\server\server.js` | `const \{ default: mockBookingsRoutes \} = await import('./routes/mockBookings.js');` | L295 |
| `.\server\server.js` | `app.use('/mock', mockBookingsRoutes);` | L296 |
| `.\server\server.js` | `console.log('   - GET  /mock/bookings');` | L298 |
| `.\server\server.js` | `console.log('   - POST /mock/bookings');` | L299 |
| `.\server\server.js` | `console.log('   - PATCH /mock/bookings/:id');` | L300 |
| `.\server\server.js` | `console.log('   - DELETE /mock/bookings/:id');` | L301 |
| `.\server\server.js` | `console.log('   - GET  /mock/bookings/availability/:packageId');` | L302 |
| `.\server\routes\mockBookings.js` | `routes: ['GET /mock/bookings', 'POST /mock/bookings']` | L11 |
| `.\server\routes\mockBookings.js` | `// GET /mock/bookings - Get all bookings (no auth required)` | L15 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] GET /bookings called', userId \|\| email ? `(filtered by $\{userId ? 'userId' : 'email'\})` : '(all bookings)');` | L19 |
| `.\server\routes\mockBookings.js` | `let bookings = Array.from(mockClient.tables.bookings.values());` | L20 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Filtered to', bookings.length, 'bookings for user');` | L29 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Found', bookings.length, 'bookings (no filter - for calendar)');` | L31 |
| `.\server\routes\mockBookings.js` | `const items = Array.from(mockClient.tables.booking_items.values())` | L36 |
| `.\server\routes\mockBookings.js` | `const packageData = mockClient.tables.packages.get(String(booking.package_id));` | L39 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Returning', enrichedBookings.length, 'enriched bookings');` | L48 |
| `.\server\routes\mockBookings.js` | `console.error('[MockBookings] Fetch error:', error);` | L51 |
| `.\server\routes\mockBookings.js` | `// POST /mock/bookings - Create new booking (no auth required)` | L56 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Creating booking:', \{ packageId, checkIn, checkOut \});` | L73 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Creating booking with user association:', \{ userId, email: guestEmail \});` | L108 |
| `.\server\routes\mockBookings.js` | `mockClient.tables.bookings.set(bookingId, booking);` | L110 |
| `.\server\routes\mockBookings.js` | `mockClient.tables.booking_items.set(itemId, \{` | L116 |
| `.\server\routes\mockBookings.js` | `mockClient.tables.booking_items.set(itemId, \{` | L132 |
| `.\server\routes\mockBookings.js` | `mockClient.tables.booking_items.set(itemId, \{` | L144 |
| `.\server\routes\mockBookings.js` | `const bookingItems = Array.from(mockClient.tables.booking_items.values())` | L153 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Booking created:', bookingId);` | L162 |
| `.\server\routes\mockBookings.js` | `console.error('[MockBookings] Create error:', error);` | L169 |
| `.\server\routes\mockBookings.js` | `// PATCH /mock/bookings/:id - Update existing booking (no auth required)` | L174 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Updating booking:', id, updates);` | L180 |
| `.\server\routes\mockBookings.js` | `const existingBooking = mockClient.tables.bookings.get(id);` | L183 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Unauthorized edit attempt:', \{` | L201 |
| `.\server\routes\mockBookings.js` | `mockClient.tables.bookings.set(id, updatedBooking);` | L240 |
| `.\server\routes\mockBookings.js` | `Array.from(mockClient.tables.booking_items.values())` | L245 |
| `.\server\routes\mockBookings.js` | `.forEach(item => mockClient.tables.booking_items.delete(item.id));` | L247 |
| `.\server\routes\mockBookings.js` | `mockClient.tables.booking_items.set(itemId, \{` | L252 |
| `.\server\routes\mockBookings.js` | `Array.from(mockClient.tables.booking_items.values())` | L267 |
| `.\server\routes\mockBookings.js` | `.forEach(item => mockClient.tables.booking_items.delete(item.id));` | L269 |
| `.\server\routes\mockBookings.js` | `mockClient.tables.booking_items.set(itemId, \{` | L274 |
| `.\server\routes\mockBookings.js` | `Array.from(mockClient.tables.booking_items.values())` | L286 |
| `.\server\routes\mockBookings.js` | `.forEach(item => mockClient.tables.booking_items.delete(item.id));` | L288 |
| `.\server\routes\mockBookings.js` | `mockClient.tables.booking_items.set(itemId, \{` | L292 |
| `.\server\routes\mockBookings.js` | `const bookingItems = Array.from(mockClient.tables.booking_items.values())` | L301 |
| `.\server\routes\mockBookings.js` | `const packageData = mockClient.tables.packages.get(String(updatedBooking.package_id));` | L304 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Booking updated:', id);` | L312 |
| `.\server\routes\mockBookings.js` | `console.error('[MockBookings] Update error:', error);` | L319 |
| `.\server\routes\mockBookings.js` | `// DELETE /mock/bookings/:id - Cancel booking (no auth required)` | L324 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Cancelling booking:', id, \{ userId, email \});` | L330 |
| `.\server\routes\mockBookings.js` | `const existingBooking = mockClient.tables.bookings.get(id);` | L332 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Unauthorized cancel attempt:', \{` | L347 |
| `.\server\routes\mockBookings.js` | `mockClient.tables.bookings.set(id, cancelledBooking);` | L367 |
| `.\server\routes\mockBookings.js` | `console.log('[MockBookings] Booking cancelled:', id);` | L369 |
| `.\server\routes\mockBookings.js` | `console.error('[MockBookings] Cancel error:', error);` | L377 |
| `.\server\routes\mockBookings.js` | `// GET /mock/bookings/availability/:packageId - Check availability (no auth required)` | L399 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Request for package $\{packageId\} from $\{checkIn\} to $\{checkOut\}, category: $\{category \|\| 'all'\} (normalized: $\{requestedCategory\}), excludeBookingId: $\{excludeBookingId \|\| 'none'\}`);` | L409 |
| `.\server\routes\mockBookings.js` | `const allBookings = Array.from(mockClient.tables.bookings.values());` | L431 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Total bookings in mock DB: $\{allBookings.length\}`);` | L434 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Sample booking IDs: $\{allBookings.slice(0, 3).map(b => b.id).join(', ')\}`);` | L436 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Booking categories found in DB:`, bookingCategories);` | L440 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Example booking categories (first 5):`,` | L441 |
| `.\server\routes\mockBookings.js` | `const bookingItems = Array.from(mockClient.tables.booking_items.values())` | L494 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Inferred category '$\{bookingCategory\}' from booking_items for booking $\{booking.id\}`);` | L510 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Excluding booking $\{booking.id\} from conflict checks (re-edit mode)`);` | L523 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Filtered to $\{relevantBookings.length\} bookings for category '$\{requestedCategory\}' (from $\{allBookings.length\} total)`);` | L538 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Total bookings matching normalized category '$\{requestedCategory\}': $\{bookingsByCategory\}`);` | L545 |
| `.\server\routes\mockBookings.js` | `const items = Array.from(mockClient.tables.booking_items.values())` | L552 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Found $\{bookedItems.length\} booked items of type '$\{itemType\}' for category '$\{category \|\| 'all'\}'`);` | L563 |
| `.\server\routes\mockBookings.js` | `console.log('[MockAvailability] Item types seen in bookedItems:', typeSample \|\| 'none');` | L566 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Date $\{dateString\}: isSingleDay=true, isBooked=true, bookingCheckIn=$\{bookingCheckIn\}, item=$\{item.item_id\}`);` | L669 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] date $\{dateString\}: bookedRooms=[$\{bookedIds.join(', ')\}], availableRooms=[$\{availableItems.join(', ')\}]`);` | L689 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] date $\{dateString\}: bookedItems=[$\{bookedIds.join(', ')\}], availableItems=[$\{availableItems.join(', ')\}], category=$\{requestedCategory\}`);` | L691 |
| `.\server\routes\mockBookings.js` | `console.warn(`[MockAvailability] ⚠️ Assertion failed: overlap between booked and available on $\{dateString\}:`, overlap);` | L698 |
| `.\server\routes\mockBookings.js` | `console.warn(`[MockAvailability] ⚠️ Assertion failed: counts exceed total on $\{dateString\}: booked=$\{bookedIds.length\}, available=$\{availableItems.length\}, total=$\{allItems.length\}`);` | L702 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability]    status=$\{status\}, bookedCount=$\{bookedIds.length\}, availableCount=$\{availableItems.length\}`);` | L750 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability]    bookedCottages=$\{JSON.stringify(bookedIds)\}, availableCottages=$\{JSON.stringify(availableItems)\}`);` | L751 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] ⚠️  $\{dateString\} HAS BOOKINGS: bookedCount=$\{bookedIds.length\}, isBooked=true, status=$\{status\}`);` | L755 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] $\{dateString\}: bookedCount=$\{bookedIds.length\}, isBooked=true, status=$\{status\}, bookedHalls=$\{JSON.stringify(bookedIds)\}, availableHalls=$\{JSON.stringify(availableItems)\}`);` | L783 |
| `.\server\routes\mockBookings.js` | `console.log(`[MockAvailability] Category '$\{requestedCategory\}': Overall availability: $\{allDatesAvailable\}, avg: $\{avgAvailability\}, booked dates: $\{bookedDateCount\}/$\{Object.keys(dateAvailability).length\}`);` | L821 |
| `.\assets\js\utils\api.js` | `const USE_MOCK_BOOKINGS = getRunMode() === 'mock';` | L6 |
| `.\assets\js\utils\api.js` | `console.log('  Using Mock Bookings:', USE_MOCK_BOOKINGS);` | L17 |
| `.\assets\js\utils\api.js` | `if (USE_MOCK_BOOKINGS) \{` | L207 |
| `.\assets\js\utils\api.js` | `console.log('[MockDB] Checking availability via mock API...', excludeBookingId ? `(excluding booking $\{excludeBookingId\})` : '');` | L208 |
| `.\assets\js\utils\api.js` | `if (USE_MOCK_BOOKINGS) \{` | L278 |
| `.\assets\js\utils\api.js` | `console.log('[MockDB] Fetching user bookings from mock API...');` | L279 |
| `.\assets\js\utils\api.js` | `if (USE_MOCK_BOOKINGS) \{` | L332 |
| `.\assets\js\utils\api.js` | `console.log('[MockDB] Creating booking via mock API...');` | L333 |
| `.\assets\js\utils\api.js` | `const data = await mockApiRequest('/bookings', \{` | L334 |
| `.\assets\js\utils\api.js` | `console.log(`[BookingAPI] Created booking using $\{USE_MOCK_BOOKINGS ? 'mock' : 'real'\} API`);` | L338 |
| `.\assets\js\utils\api.js` | `console.log(`[BookingAPI] Created booking using $\{USE_MOCK_BOOKINGS ? 'mock' : 'real'\} API`);` | L352 |
| `.\assets\js\utils\api.js` | `if (USE_MOCK_BOOKINGS) \{` | L374 |
| `.\assets\js\utils\api.js` | `console.log('[MockDB] Updating booking via mock API...');` | L375 |
| `.\assets\js\utils\api.js` | `const data = await mockApiRequest(`/bookings/$\{bookingId\}`, \{` | L376 |
| `.\assets\js\utils\api.js` | `if (USE_MOCK_BOOKINGS) \{` | L411 |
| `.\assets\js\utils\api.js` | `console.log('[MockDB] Cancelling booking via mock API...');` | L412 |
| `.\assets\js\config\aiConfig.js` | `return MOCK_RESPONSES.booking;` | L84 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `All booking CRUD operations correctly route to `/mock/*` when `USE_MOCK_BOOKINGS === true`:` | L21 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `- ✅ `fetchUserBookings()` → `/mock/bookings` (line 257)` | L22 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `- ✅ `createBooking()` → `/mock/bookings` POST (line 280)` | L23 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `- ✅ `updateBooking()` → `/mock/bookings/:id` PATCH (line 312)` | L24 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `- ✅ `cancelBooking()` → `/mock/bookings/:id` DELETE (line 337)` | L25 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `- ✅ `checkAvailability()` → `/mock/bookings/availability/:packageId` (line 204)` | L26 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `**Location**: `server/routes/mockBookings.js`` | L32 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `**Location**: `server/routes/mockBookings.js:323-361`` | L121 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `- Calendar calls `/mock/bookings/availability/:packageId` with date range (line 245)` | L174 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `- Mock API returns `dateAvailability[dateString]` with `status`, `availableRooms`, `bookedRooms` (lines 417-423 in mockBookings.js)` | L175 |
| `.\BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | `- Mock database uses in-memory Map storage; bookings persist for server session only` | L664 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `2. **TIMEZONE PARSE INCONSISTENCIES**: While server-side normalization exists (`mockBookings.js:324-343`), client-side `formatDateForInput()` uses `Date.getFullYear/Month/Date()` which are timezone-dependent when dates are parsed from ISO strings without `T00:00:00`.` | L12 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**Primary Path**: `/mock/bookings/availability/:packageId` → `dateAvailability` map` | L28 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `- **Location**: `server/routes/mockBookings.js:291-525`` | L29 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `- **Function**: `GET /mock/bookings/availability/:packageId`` | L30 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `- `server/routes/mockBookings.js:291` → `GET /mock/bookings/availability/:packageId`` | L56 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `### Required Fields (from `mockBookings.js:76-89`)` | L80 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**Location**: `server/routes/mockBookings.js:324-343`` | L144 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**Location**: `server/routes/mockBookings.js:436`` | L206 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**Location**: `server/routes/mockBookings.js:402-500`` | L240 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**Location**: `server/routes/mockBookings.js:291-525`` | L303 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `- Line 315-322: Get all bookings from `mockClient.tables.bookings`` | L306 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**Location**: `assets/js/components/calendarModal.js:344-354` and `server/routes/mockBookings.js:482-492`` | L387 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**Location**: `server/routes/mockBookings.js:424-454`` | L409 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**Location**: `server/routes/mockBookings.js:437`` | L421 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**File**: `server/routes/mockBookings.js:437`` | L470 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**File**: `server/routes/mockBookings.js`` | L535 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**File**: `server/routes/mockBookings.js`` | L644 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `**File**: `server/routes/mockBookings.js`` | L657 |
| `.\CALENDAR_DATE_RENDERING_INVESTIGATION.md` | `console.log('[MockAvailability] Date in booking range:', \{` | L662 |
| `.\server\__tests__\routes\users.test.js` | `mockClient.seed('bookings', [` | L70 |
| `.\assets\js\pages\dashboard.js` | `// Mock booking data for the user` | L13 |
| `.\assets\js\pages\dashboard.js` | `const mockBookings = [` | L14 |
| `.\assets\js\pages\dashboard.js` | `const bookingRows = mockBookings.map(booking => `` | L93 |


</details>

---

Tool use: **codebase_search**

<details>
                <summary>Searched codebase "Where are mock bookings defined or used?" • **14** results</summary>
            
| File | Lines |
|------|-------|
| `server/routes/mockBookings.js` | L15-171 |
| `server/server.js` | L112-339 |
| `server/routes/mockBookings.js` | L6-171 |
| `assets/js/pages/dashboard.js` | L605 |
| `assets/js/utils/bookingState.js` | L346 |
| `server/server.js` | L96-339 |
| `assets/js/utils/api.js` | L219-305 |
| `assets/js/utils/api.js` | L288-387 |
| `assets/js/components/bookingModal.js` | L20-125 |
| `server/routes/mockBookings.js` | L53-321 |
| `BOOKING_CALENDAR_DIAGNOSTIC_REPORT.md` | L52 |
| `server/routes/mockBookings.js` | L53 |
| `server/db/mockDatabaseClient.js` | L109 |
| `assets/js/config/aiConfig.js` | L8-53 |

</details>

---



---

Checking where mock bookings are seeded so we can remove them:


---

Tool use: **read_file**

Read file: server/server.js

---

Tool use: **read_file**

Read file: server/db/mockDatabaseClient.js

---



---

Removing the mock booking seed data:


---

Tool use: **read_file**

Read file: server/server.js

---



---

Removing the mock booking seed data:


---

Tool use: **search_replace**


<details><summary>Edit file: server/server.js</summary>

**Chunk 1**
Lines added: undefined, lines removed: 68

```diff
@@ -220,72 +220,4 @@
        ]);
        console.log('✅ Default packages seeded');
-       
-       // Seed test bookings for development/testing
-       console.log('🧩 Seeding test bookings for mock database...');
-       mockClient.seed('bookings', [
-         // Cottage booking on November 4, 2025 - Garden Cottage and Family Cottage booked
-         {
-           id: 1,
-           package_id: 1,
-           user_id: 'test-user-1',
-           category: 'cottages',
-           check_in: '2025-11-04',
-           check_out: '2025-11-04',
-           adults: 4,
-           children: 2,
-           special_requests: 'Test cottage booking',
-           status: 'confirmed',
-           total_price: 17700,
-           created_at: '2025-10-15T10:00:00.000Z'
-         },
-         // Room booking on November 10-12, 2025
-         {
-           id: 2,
-           package_id: 1,
-           user_id: 'test-user-2',
-           category: 'rooms',
-           check_in: '2025-11-10',
-           check_out: '2025-11-12',
-           adults: 2,
-           children: 0,
-           special_requests: 'Test room booking',
-           status: 'confirmed',
-           total_price: 11000,
-           created_at: '2025-10-16T14:30:00.000Z'
-         }
-       ]);
-       
-       mockClient.seed('booking_items', [
-         // Cottage booking items for November 4
-         {
-           id: 1,
-           booking_id: 1,
-           item_type: 'cottage',
-           item_id: 'Garden Cottage',
-           guest_name: 'Test Guest 1',
-           adults: 2,
-           children: 1
-         },
-         {
-           id: 2,
-           booking_id: 1,
-           item_type: 'cottage',
-           item_id: 'Family Cottage',
-           guest_name: 'Test Guest 2',
-           adults: 2,
-           children: 1
-         },
-         // Room booking items for November 10-12
-         {
-           id: 3,
-           booking_id: 2,
-           item_type: 'room',
-           item_id: 'Room A1',
-           guest_name: 'Test Guest 3',
-           adults: 2,
-           children: 0
-         }
-       ]);
-       console.log('✅ Test bookings seeded');
      }
      
```

</details>

---



---

Removed the mock booking seed data from the server. Checking for lint errors:


---

Tool use: **read_lints**

<details>
          <summary>Read lints for 1 file</summary>
      
Lint paths:

- `server/server.js`

Lint results


**No lint errors found**
</details>

---



---

Removed the mock booking seed data from `server/server.js`.

The server will no longer seed test bookings on startup. Removed:
- 2 test bookings (cottage booking on Nov 4, 2025, and room booking on Nov 10–12, 2025)
- 3 associated booking items

The mock database will start empty, and bookings can still be created through the booking API.

If the server is running, restart it for the changes to take effect.

---

